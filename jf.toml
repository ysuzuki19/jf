[meta]
version = "0.1.0"

[job.setup-dev]
mode = "shell"
script = """
cargo install cargo-binstall
cargo binstall cargo-llvm-cov
"""

[job.install]
mode = "sequential"
jobs = ["only-test", "only-install"]

[job.uninstall]
command = "cargo"
args = ["uninstall"]

[job.update]
mode = "sequential"
jobs = ["git-pull", "install"]

[job.live-test-coverage]
mode = "watch"
job = "test-coverage"
watch_list = ["src/**", "Cargo.toml"]

[job.test-coverage-display]
command = "cargo"
args = ["llvm-cov"]

[job."test-coverage"]
command = "cargo"
args = ["llvm-cov", "--lcov", "--output-path", "target/lcov.info"]

[job."live-llvm-cov:html"]
mode = "watch"
job = "llvm-cov:html"
watch_list = ["src/**", "Cargo.toml"]

[job."llvm-cov:html"]
command = "cargo"
args = ["llvm-cov", "--html"]

[job.live-test]
mode = "watch"
job = "only-test"
watch_list = ["src/**", "Cargo.toml"]

[job.live-run]
mode = "watch"
job = "run"
watch_list = ["src/**", "Cargo.toml"]

[job.test-run]
mode = "sequential"
jobs = ["only-test", "run"]

[job.run]
command = "cargo"
args = ["run"]
description = "run the project"

[job.only-test]
command = "cargo"
args = ["test", "--release"]
description = "run the tests"

[job.only-build]
command = "cargo"
args = ["build"]

[job.only-install]
command = "cargo"
args = ["install", "--path", "."]

[job.test-build]
mode = "parallel"
jobs = ["only-test", "only-build"]

[job.git-pull]
command = "git"
args = ["pull"]
